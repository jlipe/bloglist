(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a),s=n(21),i=n.n(s),o=n(10),u=n(26),l=n(58),d=n(59),j=n(6),b=n.n(j),h=n(7),p=null,O=function(e,t,n){return p&&clearInterval(p),function(){var r=Object(h.a)(b.a.mark((function r(a){return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:p=setTimeout((function(){a({type:"SET_MESSAGE",data:{message:"",type:null}})}),1e3*n),a({type:"SET_MESSAGE",data:{message:e,type:t}});case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:"",type:null},t=arguments.length>1?arguments[1]:void 0;switch(console.log("Action: ",t),console.log("State: ",e),t.type){case"SET_MESSAGE":return{message:t.data.message,type:t.data.type};default:return e}},x=n(63),m=n(19),g=n.n(m),v="/api/blogs",y=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:r}},e.next=3,g.a.post(v,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n||(n=t.id),a={headers:{Authorization:r}},e.next=4,g.a.put(v+"/".concat(n),t,a);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(b.a.mark((function e(t,n){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("comment",t),e.next=3,g.a.post(v+"/".concat(n,"/comments"),{comment:t});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),S={setToken:function(e){r="bearer ".concat(e)},getAll:function(){return g.a.get(v).then((function(e){return e.data}))},create:y,update:w,remove:function(){var e=Object(h.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:r}},e.next=3,g.a.delete(v+"/".concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:k},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("Action: ",t),console.log("State: ",e),t.type){case"INIT_BLOGS":return t.data;case"SORT_BLOGS":return e.slice().sort((function(e,t){return t.likes-e.likes}));case"ADD_COMMENT":return e.map((function(e){return e.id===t.data.id?e.comments=e.comments.concat(t.data.comment):e}));case"ADD_BLOG":return[].concat(Object(x.a)(e),[t.data.blog]);case"UPDATE_BLOG":return e.map((function(e){return e.id===t.data.blog.id?t.data.blog:e}));case"REMOVE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},L={login:function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},U={addUser:function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(console.log("Action: ",t.type),console.log("State: ",e),t.type){case"INIT_USER":case"SET_USER":return t.data.user;case"REMOVE_USER":return null;default:return e}},I=Object(u.combineReducers)({message:f,blogs:E,user:A}),N=Object(u.createStore)(I,Object(d.composeWithDevTools)(Object(u.applyMiddleware)(l.a))),_=n(9),C=n(8),T=n(96),B=n(18),G=n(1),R=c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),r=Object(B.a)(n,2),c=r[0],s=r[1],i={display:c?"none":""},o={display:c?"":"none"},u=function(){s(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(G.jsxs)("div",{children:[Object(G.jsx)("div",{style:i,children:Object(G.jsx)(T.a,{className:"m-2",onClick:u,children:e.buttonLabel})}),Object(G.jsxs)("div",{style:o,children:[e.children,Object(G.jsx)(T.a,{className:"m-2",variant:"warning",onClick:u,children:"cancel"})]})]})}));R.displayName="Togglable";var D=R,M=n(101),P=function(){var e=Object(o.c)((function(e){return e.message}));return""===e.message?null:Object(G.jsx)(M.a,{variant:e.type,children:e.message})},V=n(25),J=function(e){var t=Object(a.useState)(""),n=Object(B.a)(t,2),r=n[0],c=n[1];return{type:e,value:r,onChange:function(e){c(e.target.value)}}},q=n(97),z=n(99),F=function(){var e=Object(o.b)(),t=Object(C.f)(),n=J("text"),r=J("password");return Object(G.jsxs)(q.a,{fluid:!0,children:[Object(G.jsx)("h2",{children:"Log in to application"}),Object(G.jsxs)(z.a,{onSubmit:function(a){a.preventDefault(),e(function(e,t){return function(){var n=Object(h.a)(b.a.mark((function n(r){var a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,L.login({username:e,password:t});case 3:a=n.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(a)),S.setToken(a.token),r(O("".concat(a.username," logged in"),"success",3)),r({type:"SET_USER",data:{user:a}}),n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(0),r(O("Invalid login","danger",3)),n.abrupt("return",Promise.reject("Invalid Login"));case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(n.value,r.value)).then((function(){return t.push("/")})).catch((function(){return console.log("invalid login")}))},children:[Object(G.jsxs)(z.a.Group,{controlId:"formUsername",children:[Object(G.jsx)(z.a.Label,{children:"Username:"}),Object(G.jsx)(z.a.Control,Object(V.a)({},n))]}),Object(G.jsxs)(z.a.Group,{controlId:"formPassword",children:[Object(G.jsx)(z.a.Label,{children:"Password"}),Object(G.jsx)(z.a.Control,Object(V.a)({},r))]}),Object(G.jsx)(T.a,{variant:"primary",type:"submit",children:"Login"}),Object(G.jsx)(_.b,{to:"/signup",children:Object(G.jsx)(T.a,{variant:"secondary",className:"m-2",children:"Sign Up"})})]}),Object(G.jsx)("p",{children:"If you want to post a new blog entry or comment on blogs you must be signed in. Either create an account on the sign up page, or login with the username: 'test_user' password: 'test_password'"})]})},H=n(62),W=n(98),K=function(e){var t,n=e.blogs,r={},a=Object(H.a)(n);try{for(a.s();!(t=a.n()).done;){var c=t.value;c.user.username in r?r[c.user.username].count++:r[c.user.username]={count:1,id:c.user.id}}}catch(s){a.e(s)}finally{a.f()}return Object(G.jsxs)("div",{children:[Object(G.jsx)("h2",{children:"Users"}),Object(G.jsxs)(W.a,{children:[Object(G.jsx)("thead",{children:Object(G.jsxs)("tr",{children:[Object(G.jsx)("th",{children:"User"}),Object(G.jsx)("th",{children:"# blogs added"})]})}),Object(G.jsx)("tbody",{children:Object.keys(r).map((function(e){return Object(G.jsxs)("tr",{children:[Object(G.jsx)("td",{children:Object(G.jsx)(_.b,{to:"/users/".concat(r[e].id),children:e})}),Object(G.jsx)("td",{children:r[e].count})]},r[e].id)}))})]})]})},Q=function(e){var t=e.blogs,n=Object(o.b)(),r=t.map((function(e){return Object(G.jsxs)("tr",{children:[Object(G.jsx)("td",{children:Object(G.jsx)(_.b,{to:"/blogs/".concat(e.id),children:e.title})}),Object(G.jsx)("td",{children:e.author}),Object(G.jsx)("td",{children:Object(G.jsx)(T.a,{className:"ml-2",variant:"danger",onClick:function(){return n(function(e){return function(){var t=Object(h.a)(b.a.mark((function t(n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.remove(e.id);case 3:t.sent,n({type:"REMOVE_BLOG",data:{id:e.id}}),n(O("".concat(e.title," successfully removed"),"success",3)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(O("Cannot delete blog","danger",3));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e))},id:"delete",children:"delete"})})]},e.id)}));return Object(G.jsxs)("div",{children:[Object(G.jsx)(T.a,{className:"m-2",onClick:function(){return n(function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SORT_BLOGS"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Sort Blogs by Likes"}),Object(G.jsxs)(W.a,{striped:!0,bordered:!0,hover:!0,children:[Object(G.jsx)("thead",{children:Object(G.jsxs)("tr",{children:[Object(G.jsx)("th",{children:"Title"}),Object(G.jsx)("th",{children:"Author"}),Object(G.jsx)("th",{})]})}),Object(G.jsx)("tbody",{children:r})]})]})},X=function(e){var t=e.handleSubmit,n=Object(a.useState)(""),r=Object(B.a)(n,2),c=r[0],s=r[1],i=Object(a.useState)(""),o=Object(B.a)(i,2),u=o[0],l=o[1],d=Object(a.useState)(""),j=Object(B.a)(d,2),b=j[0],h=j[1];return Object(G.jsx)(z.a,{onSubmit:function(e,n){e.preventDefault();var r={title:c,author:u,url:b,user:n};s(""),l(""),h(""),t(r)},id:"blogForm",children:Object(G.jsxs)(z.a.Group,{children:[Object(G.jsx)(z.a.Label,{children:"Title:"}),Object(G.jsx)(z.a.Control,{type:"text",id:"text",value:c,name:"blog_title",onChange:function(e){var t=e.target;return s(t.value)},required:!0}),Object(G.jsx)(z.a.Label,{children:"Author:"}),Object(G.jsx)(z.a.Control,{type:"text",id:"author",value:u,name:"blog_author",onChange:function(e){var t=e.target;return l(t.value)},required:!0}),Object(G.jsx)(z.a.Label,{children:"URL:"}),Object(G.jsx)(z.a.Control,{type:"text",id:"url",value:b,name:"blog_url",onChange:function(e){var t=e.target;return h(t.value)},required:!0}),Object(G.jsx)(T.a,{type:"submit",className:"mt-2 ml-2",children:"create"})]})})},Y=n(103),Z=function(e){var t=e.blogs,n=Object(C.g)().id,r=t.filter((function(e){return e.user.id===n}));if(0===r.length)return null;var a=r[0].user.username,c=Object(G.jsx)(Y.a,{children:r.map((function(e){return Object(G.jsx)(Y.a.Item,{children:Object(G.jsx)(_.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))});return Object(G.jsxs)("div",{children:[Object(G.jsx)("h4",{children:a}),Object(G.jsx)("h2",{children:"Added Blogs"}),c]})},$=function(e){var t=e.blogs,n=Object(o.b)(),r=Object(C.g)().id,c=Object(a.useState)(""),s=Object(B.a)(c,2),i=s[0],u=s[1],l=t.find((function(e){return e.id===r}));if(!l)return null;var d=l.comments.map((function(e,t){return Object(G.jsx)(Y.a.Item,{children:e},t)}));return Object(G.jsxs)("div",{children:[Object(G.jsx)("h2",{children:Object(G.jsx)("em",{children:l.title})}),Object(G.jsx)("a",{href:l.url,children:l.url}),Object(G.jsxs)("p",{className:"mt-2",children:["Likes ",Object(G.jsx)("span",{id:"likes",children:l.likes}),"  ",Object(G.jsx)(T.a,{type:"button",className:"likeButton",size:"sm",variant:"outline-secondary",onClick:function(){return n(function(e){return e.likes++,function(){var t=Object(h.a)(b.a.mark((function t(n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.update(e);case 2:n({type:"UPDATE_BLOG",data:{blog:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(l))},id:"likeButton",children:"Like"})]}),Object(G.jsxs)("p",{children:["Added by ",l.user?l.user.username:null]}),Object(G.jsx)("h3",{children:"Comments"}),Object(G.jsxs)(z.a,{inline:!0,onSubmit:function(e){e.preventDefault(),n(function(e,t){return function(){var n=Object(h.a)(b.a.mark((function n(r){var a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.addComment(t,e.id);case 2:a=n.sent,r({type:"UPDATE_BLOG",data:{blog:a}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(l,i)),u("")},children:[Object(G.jsx)(z.a.Control,{className:"mb-2 mr-sm-2 col-5",value:i,onChange:function(e){return u(e.target.value)}}),Object(G.jsx)(T.a,{type:"submit",className:"mb-2",children:"Add Comment"})]}),Object(G.jsx)(Y.a,{className:"mb-2 mr-sm-2 col-5",variant:"flush",children:d})]})},ee=n(100),te=n(102),ne=function(e){var t=e.user,n=Object(o.b)();return Object(G.jsx)(G.Fragment,{children:Object(G.jsxs)(ee.a,{bg:"dark",expand:"lg",variant:"dark",children:[Object(G.jsxs)(te.a,{className:"mr-auto",children:[Object(G.jsx)(te.a.Link,{as:_.b,to:"/blogs",children:"Blogs"}),Object(G.jsx)(te.a.Link,{as:_.b,to:"/users",children:"Users"})]}),Object(G.jsx)(te.a,{children:t?Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(ee.a.Brand,{children:"".concat(t.username," logged in")}),Object(G.jsx)(T.a,{onClick:function(){return n(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=JSON.parse(window.localStorage.getItem("loggedBlogAppUser")),window.localStorage.removeItem("loggedBlogAppUser"),S.setToken(""),t(O("".concat(n.username," logged out"),"success",3)),t({type:"REMOVE_USER"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"Log out"})]}):Object(G.jsx)(te.a.Item,{children:Object(G.jsx)(te.a.Link,{as:_.b,to:"/login",children:"Login"})})})]})})},re=function(){var e=Object(o.b)(),t=Object(C.f)(),n=J("text"),r=J("password");return Object(G.jsxs)(q.a,{fluid:!0,children:[Object(G.jsx)("h2",{children:"Sign Up"}),Object(G.jsxs)(z.a,{onSubmit:function(a){a.preventDefault(),e(function(e,t){return function(){var n=Object(h.a)(b.a.mark((function n(r){var a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,U.addUser({username:e,password:t});case 3:a=n.sent,r(O("".concat(a.username," successfully added"),"success",3)),n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(0),r(O("Username already in use","danger",3)),n.abrupt("return",Promise.reject("Invalid Login"));case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()}(n.value,r.value)).then((function(){return t.push("/login")})).catch((function(){return console.log("invalid signup")}))},children:[Object(G.jsxs)(z.a.Group,{controlId:"formUsername",children:[Object(G.jsx)(z.a.Label,{children:"Username:"}),Object(G.jsx)(z.a.Control,Object(V.a)(Object(V.a)({},n),{},{placeholder:"Enter Username"})),Object(G.jsx)(z.a.Text,{className:"text-muted",children:"Username must be unique"})]}),Object(G.jsxs)(z.a.Group,{controlId:"formPassword",children:[Object(G.jsx)(z.a.Label,{children:"Password"}),Object(G.jsx)(z.a.Control,Object(V.a)(Object(V.a)({},r),{},{placeholder:"Enter Password"}))]}),Object(G.jsx)(T.a,{variant:"primary",type:"submit",children:"Sign Up"}),Object(G.jsx)(_.b,{to:"/login",children:Object(G.jsx)(T.a,{variant:"secondary",className:"m-2",children:"Login"})})]})]})},ae=(n(93),function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.blogs})),n=Object(o.c)((function(e){return e.user}));Object(a.useEffect)((function(){e(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=JSON.parse(window.localStorage.getItem("loggedBlogAppUser")))&&(S.setToken(n.token),t({type:"INIT_USER",data:{user:n}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(a.useEffect)((function(){e(function(){var e=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var r=Object(a.useRef)();return Object(G.jsx)("div",{className:"container",children:Object(G.jsxs)(_.a,{children:[Object(G.jsx)(ne,{user:n}),Object(G.jsx)(P,{}),Object(G.jsx)("h2",{children:"Blogs"}),Object(G.jsxs)(C.c,{children:[Object(G.jsx)(C.a,{path:"/users/:id",children:Object(G.jsx)(Z,{blogs:t})}),Object(G.jsx)(C.a,{path:"/users",children:Object(G.jsx)(K,{blogs:t})}),Object(G.jsx)(C.a,{path:"/blogs/:id",children:Object(G.jsx)($,{blogs:t})}),Object(G.jsx)(C.a,{path:"/signup",children:Object(G.jsx)(re,{})}),Object(G.jsx)(C.a,{path:"/login",children:Object(G.jsx)(F,{})}),Object(G.jsx)(C.a,{path:"/",children:Object(G.jsxs)("div",{children:[n?Object(G.jsx)(D,{buttonLabel:"New Blog",ref:r,children:Object(G.jsx)(X,{user:n,handleSubmit:function(t){e(function(e){return function(){var t=Object(h.a)(b.a.mark((function t(n){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.create(e);case 2:r=t.sent,n({type:"ADD_BLOG",data:{blog:r}}),n(O("a new blog ".concat(r.title," by ").concat(r.author," added"),"success",3));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)),r.current.toggleVisibility()}})}):Object(G.jsx)(_.b,{to:"/login",children:Object(G.jsx)(T.a,{variant:"warning",className:"ml-2",children:"Login to add a blog"})}),Object(G.jsx)(Q,{blogs:t})]})})]})]})})}),ce=document.getElementById("root");i.a.render(Object(G.jsx)(o.a,{store:N,children:Object(G.jsx)(ae,{})}),ce)}},[[94,1,2]]]);
//# sourceMappingURL=main.4a8fa5c5.chunk.js.map